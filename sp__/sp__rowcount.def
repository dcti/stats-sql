#!/usr/local/bin/sqsh -i

\set procedure=sp__rowcount
use sybsystemprocs
go

print "Creating procedure $procedure"
go
if object_id("$procedure") is not NULL
begin
	drop procedure $procedure
end
go
create procedure $procedure
(	@table varchar(92)		/* Table to report on */
)
as
begin
	-- $Id: sp__rowcount.def,v 1.2 2001/12/21 21:17:45 decibel Exp $
	declare @count		int		/* Row count to return */

	/* See if the object exists */
	if (object_id(@table) is null)
	begin
		raiserror 99999 "Table %1! does not exist!", @table
		return -1
	end

	select @count = sum(rowcnt(doampg))
	from sysindexes
	where id = object_id(@table)

	return @count
end
go

grant execute on $procedure to public
go
