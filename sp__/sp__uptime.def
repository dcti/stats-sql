#!/usr/local/bin/sqsh -i

\set procedure=sp__uptime
use sybsystemprocs
go

print "Creating procedure $procedure"
go
if object_id("$procedure") is not NULL
begin
	drop procedure $procedure
end
go
create procedure $procedure
AS
BEGIN                                                           
	-- $Id: sp__uptime.def,v 1.2 2001/12/21 21:17:45 decibel Exp $
	/*                                                          
	** sp__uptime                                               
	** ----------                                               
	**                                                          
	** Version    :  v%I% (Same as %M% version)                 
	** Archived as:  dba:/u/sybase/SCCS/s.sybdbas.pl            
	** Uptime for the SQLSvr.                                   
	**                                                          
	** Author:  FJ Lundy, Hiway Technologies, 7/98              
	*/                                                          
	                                                            
	/*                                                          
	** Vars                                                     
	*/                                                          
	DECLARE @hrs_uptime  int                                   
	DECLARE @days_uptime int                                   
	                                                            
	/*                                                          
	** Calc                                                     
	*/                                                          
	SELECT  @hrs_uptime = datediff(hour, crdate, getdate())    
	FROM    master..sysdatabases                                
	WHERE   name = 'tempdb'                                     
	                                                            
	SELECT  @days_uptime = floor(@hrs_uptime / 24)            
	SELECT  @hrs_uptime  = @hrs_uptime - (@days_uptime * 24) 
	SELECT  convert(varchar, @days_uptime) + ' days ' +        
	        convert(varchar, @hrs_uptime)  + ' hours'          
	        'uptime'                                            
END                                                             
 
go

grant execute on $procedure to public
go
