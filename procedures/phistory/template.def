-- $Id: template.def,v 1.3 2000/10/18 22:13:18 decibel Exp $

\set procedure=p_phistory_${2}

use ${1}
go

\echo "Creating table #phistory"
create table #phistory
(
	DATE		smalldatetime,
	WORK_UNITS	numeric(20,0)
)
go

\echo "Creating procedure $procedure, using ORDER BY ${3}"
create procedure $procedure
(
	@scale		numeric(20,0)	/* What to scale the results by */
)
as
	select DATE, sum(WORK_UNITS)/@scale as WORK_UNITS
	from #phistory
	group by DATE
	order by ${3}

	return @@rowcount

go

grant execute on $procedure to public
go

